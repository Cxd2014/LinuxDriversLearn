### 问题

前几天技术支持的人找我解决客户那边AC上面的问题，我发现我们这边的唯一方法就是telnet进入AC后台,然后ps查看一下进程的运行情况。
但是telnet不能输出后台进程通过printf函数打印出来的信息，只能打印你在终端上执行命令时的输出。所以非常不便于问题的定位。

这几天我写了一个程序来解决这个问题，方法是将打印到串口上的所有信息都保存到`/proc/uar`t文件中，
这样就可以通过telnet来查看后台进程打印的信息，便于定位问题出现的地方。（仿照流控抓包的方法）

### 实现方法：
在Linux内核的tty(在`/drivers/char/tty_io.c`文件中的`do_tty_write`函数中)模块中，获取所有输出到终端的打印信息，
然后写了一个内核模块来接受这些信息并将信息保存到`/proc/uart`文件中。
在telnet端就可以通过 `cat /proc/uart` 命令来查看输出信息。

### 对内核的影响：
在不加载内核模块的情况下，每次终端的输出会做一次`if(NULL != telnet_uart_match)`这个判断。
加载了内核模块后，将执行第二个`if`判断语句，然后进入到内核模块中处理。

(对于发布的产品完全不需要这个内核模块，只在远程调试的时候将内核模块下载到板子中然后加载进内核，所以对产品的性能影响仅仅是多了一个 if 判断语句)